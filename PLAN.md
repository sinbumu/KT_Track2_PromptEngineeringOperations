# PLAN.md — KT Track2 프롬프트 엔지니어링 운영 계획 (Cursor + GPT-5)

본 문서는 **2025-08-25 \~ 2025-09-10** 동안 진행될 온라인 예선 대응을 위한 **실행 계획**입니다.
목표는 **형식 100% 준수**, **분류 정확도 극대화**, **한글/길이 가산점 확보**, **A/B 실험의 빠른 수렴**입니다.

---

## 0) 대회 요약

* **트랙**: GPT-4o 기반 Custom 모델(beta)용 **시스템 프롬프트 설계**
* **출력 형식**: `번호. 유형,극성,시제,확실` (쉼표만, 공백 금지, 여분 텍스트 금지)
* **라벨 셋**

  * 유형: 사실형 / 추론형 / 대화형 / 예측형
  * 극성: 긍정 / 부정 / 미정
  * 시제: 과거 / 현재 / 미래
  * 확실성: 확실 / 불확실
* **점수(1.0 만점)**: 0.8 × 정확도 + 0.1 × 한글 비율 + 0.1 × 프롬프트 길이
* **제출 제한**: 1일 3회 (Public score 반영)

> **원칙**: 외부 데이터 금지. 시스템 프롬프트만으로 해결. **형식 위반은 해당 샘플 0점**이므로, 형식 안정성이 1순위.

---

## 1) 저장소 구조

```
.
├─ prompts/
│  ├─ system_v1_ko.txt            # 기준안
│  └─ system_v1_variants/         # 미세조정 A/B 후보
├─ outputs/
│  └─ YYYYMMDD_HHMM_run.txt       # 제출 직전 원본(수정 금지)
├─ tools/
│  └─ validate_outputs.py         # 로컬 형식 검증기
└─ experiments/
   ├─ experiments.csv             # 제출 로그(점수/길이/한글비율/변경점)
   └─ notes.md                    # 관찰/교훈/다음 가설
```

---

## 2) 환경 & 도구

* **IDE**: Cursor (GPT-5 연결)
* **브랜치 전략**

  * `main`: 안정판(제출 검증 통과·재현됨)
  * `exp/YYYYMMDD-A` `exp/YYYYMMDD-B`: 하루 2개 A/B 가설
* **커밋 컨벤션 예시**

  * `feat(prompt): v1 우선순위 조정(예측형>추론형)`
  * `test(eval): 0826-B 제출 결과 0.742`
  * `docs(log): experiments.csv 업데이트`
* **태그**: `submit-YYYYMMDD-n` (n=1..3, 당일 제출 식별)

---

## 3) 워크플로우 (하루 3회 사이클)

### (A) 오전 – 안정판 1회

1. `prompts/system_v1_ko.txt` 미세 정리(오탈자/중복 제거 – 의미 변경 없음)
2. 드라이런 → **형식 검증**: `python tools/validate_outputs.py outputs/2025xxxx_1.txt`
3. 제출 → `experiments/experiments.csv` 기록

### (B) 오후 – A/B 실험 2회

1. **단 하나의 변경 가설**만 적용 (예: 트리거 키워드 범위, 우선순위 교체, 기본값 수정)
2. `prompts/system_v1_variants/system_v1_ko_YYYYMMDD_A.txt(B.txt)`로 저장
3. 드라이런 → 형식 검증 → 제출 → 로그 기록
4. 결과 비교 후 **승자 가설만** 다음날 `main`으로 승격

> **금지**: 하루에 여러 축(우선순위+키워드+기본값)을 동시에 바꾸지 않기(원인 해석 불가).

---

## 4) 시스템 프롬프트 설계 원칙 (v1 기준)

* **전부 한국어**로 작성하여 한글 비율 가점 확보
* 3,000자 한도 가까이 **규칙·우선순위·경계사례·기본값·형식강제**를 상세히 기술
* **형식 안전장치** 포함

  * 정규식 수준 패턴:
    `^\d+\. (사실형|추론형|대화형|예측형),(긍정|부정|미정),(과거|현재|미래),(확실|불확실)$`
  * 중간사고/설명 출력 금지, 불일치 시 해당 라인 즉시 재작성
* **우선순위(초기값)**: `대화형 > 예측형 > 추론형 > 사실형`
* **기본값(모호 시)**: `유형=사실형, 극성=미정, 시제=현재, 확실성=확실`

  * 단, “가능성/전망/추정/검토/예상” 출현 시 `확실성=불확실` 및 경우에 따라 `예측형/추론형`으로 보정
* **보도/판결 규칙**: “A는 B라고 밝혔다/판결했다”

  * 핵심 술어가 ‘밝혔다/판결했다’면 **사실형·과거·확실**
  * 문장 핵심이 ‘B(전망/계획)’이면 **예측형·미래·(대체로)불확실**

---

## 5) 변경 가설(저위험→고효과)

* **기본값 조정**: 도메인 특성에 따라 `시제=과거` 또는 `확실성=불확실`로 미세 이동
* **우선순위 스왑**: `예측형` vs `추론형`의 우선 판단 순서 교체
* **트리거 목록 가감**: 미래(“\~겠다/예정/전망”)·불확실(“가능성/추정/검토/예상”) 키워드 리스트 길이 조정
* **보도문 해석**: 인용·발표문에서 핵심 술어 기준을 다르게 실험

> 한 번에 **하나씩만** 바꾸며, 점수 개선이 확인되면 그 가설만 유지.

---

## 6) 검증 & 제출 체크리스트

* [ ] 출력 라인 수 = 입력 문장 수
* [ ] 각 라인 형식:
  `^\d+\. (사실형|추론형|대화형|예측형),(긍정|부정|미정),(과거|현재|미래),(확실|불확실)$`
* [ ] 라벨 사이 **공백 없음**, 추가 텍스트 **없음**
* [ ] `python tools/validate_outputs.py outputs/…txt` **성공**
* [ ] `experiments.csv` 즉시 기록(점수/길이/한글비율/변경점)

---

## 7) 실험 로그(experiments.csv) 스키마

* **date\_kst**
* **prompt\_file** (파일명 또는 커밋 해시)
* **variant** (예: `v1`, `2025-08-27-A`)
* **notes** (핵심 변경 1줄, 관찰 1\~2줄)
* **public\_score**
* **private\_score** (예선 종료 후 갱신)
* **length\_chars** (시스템 프롬프트 길이)
* **ko\_ratio** (한글 문자 비율 추정치)

---

## 8) 위험요소 & 대응

* **형식 파손 → 0점**: 프롬프트에 형식강제 + 로컬 검증기로 이중 방지
* **과적합/불안정**: A/B 단일 가설만 운영, 최소 2일 이상 일관되면 채택
* **한글/길이 미달**: 규칙 설명을 한국어로 확대(중복은 줄이고 사례는 구체화)
* **시간 압박(1일 3회)**: 오전 안정판, 오후 A/B 2회 고정 루틴

---

## 9) 일정표 (2025-08-25 \~ 2025-09-10)

> 매일: 오전 안정판 1회, 오후 A/B 각 1회 (총 3회)

* 2025-08-25 (월)  ☐ 안정판  ☐ A  ☐ B
* 2025-08-26 (화)  ☐ 안정판  ☐ A  ☐ B
* 2025-08-27 (수)  ☐ 안정판  ☐ A  ☐ B
* 2025-08-28 (목)  ☐ 안정판  ☐ A  ☐ B
* 2025-08-29 (금)  ☐ 안정판  ☐ A  ☐ B
* 2025-08-30 (토)  ☐ 안정판  ☐ A  ☐ B
* 2025-08-31 (일)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-01 (월)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-02 (화)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-03 (수)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-04 (목)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-05 (금)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-06 (토)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-07 (일)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-08 (월)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-09 (화)  ☐ 안정판  ☐ A  ☐ B
* 2025-09-10 (수)  ☐ 안정판  ☐ A  ☐ B

---

## 10) Cursor + GPT-5 운영 팁

* **Context 최소화**: 시스템 프롬프트(규칙)만 제공, 과거 출력 샘플은 붙이지 않음(외부데이터 간주 위험 회피)
* **파일 핀**: `prompts/system_v1_ko.txt`를 Sidebar에 고정, variants는 별도 탭에서 편집
* **런북 스니펫**: 제출 전 자동으로 `validate_outputs.py`를 실행하는 npm/pnpm 스크립트 추가 고려
* **Diff 리뷰**: PR에서 프롬프트 diff 시각 점검(불필요 표현·영문 혼입 제거)

---

## 11) 다음 액션

* [ ] 이 PLAN.md 커밋(초기 커밋)
* [ ] `system_v1_ko.txt`를 커스텀 모델 **시스템 프롬프트**에 등록
* [ ] `outputs/`에 첫 드라이런 결과 저장 → 검증기 통과 후 **첫 제출**
* [ ] 결과 반영하여 **내일의 A/B 가설 1개** 선정
